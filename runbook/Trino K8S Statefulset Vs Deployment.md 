Deployment
	‚Ä¢	Nature: Stateless, ephemeral pods.
	‚Ä¢	Best for: Elastic compute, autoscaling, rolling upgrades.
	‚Ä¢	Storage: emptyDir (ephemeral), usually fine since Trino is memory-first.
	‚Ä¢	Scaling: Native support for Horizontal Pod Autoscaler (HPA).
	‚Ä¢	Use case: Most Trino clusters where workers act as pure compute engines and queries fit in memory or tolerate ephemeral spill.
	‚Ä¢	Why: Matches Trino‚Äôs design (stateless workers, coordinator reschedules tasks).

‚∏ª

StatefulSet
	‚Ä¢	Nature: Stable pod identity + persistent volumes (PVCs).
	‚Ä¢	Best for: Workers that need node-local SSD/NVMe for spill, cache, or shuffle survival across restarts.
	‚Ä¢	Storage: volumeClaimTemplates for binding local PVs.
	‚Ä¢	Scaling: Slower, heavier lifecycle; less natural for HPA.
	‚Ä¢	Use case: Specialized clusters for long-running, data-intensive queries where disk spill performance is critical.
	‚Ä¢	Why: Ensures each worker keeps the same volume + hostname, improving predictable performance.

‚∏ª

üö¶ Rule of Thumb
	‚Ä¢	Deployment ‚Üí default, fits query engine residency (elastic, stateless, cloud-native).
	‚Ä¢	StatefulSet ‚Üí niche, only if fast local NVMe spill/cache is essential.

‚∏ª

üëâ In short:
Trino = query engine = compute elasticity ‚áí Deployment is the natural fit.
StatefulSet is an optimization for special workloads that push beyond memory into heavy spill.

![Trino K8S workers decision tree](./trino_k8s_workers_decision_tree.png)

# Flow 
flowchart TD
    %% Root
    A["Do you need persistent NVMe spill/cache<br>or stable pod identities?"]

    %% Branches
    A -->|Yes| B["StatefulSet"]

    A -->|No| C["Deployment"]


    %% StatefulSet branch
    B --> B1{"Do long queries regularly spill<br>and cache re-warm is expensive?"}

    B1 -->|Yes| B2["‚úÖ Stick with StatefulSet<br>(local NVMe PVs)"]

    B1 -->|No| B3["‚û°Ô∏è Consider Deployment<br>for simpler elasticity"]


    %% Deployment branch
    C --> C1{"Is compute elasticity and<br>fast scale-up/down the priority?"}

    C1 -->|Yes| C2["‚úÖ Deployment is the natural fit"]

    C1 -->|No| C3["‚û°Ô∏è Reassess storage needs<br>StatefulSet if spill dominates"]


    %% Styling
    style A fill:#ffffff,stroke:#333,stroke-width:1px
    style B fill:#e0e7ff,stroke:#1d4ed8,stroke-width:1px
    style C fill:#e0f7ff,stroke:#0369a1,stroke-width:1px
    style B2 fill:#d1fae5,stroke:#047857,stroke-width:1.5px
    style C2 fill:#d1fae5,stroke:#047857,stroke-width:1.5px
    style B3 fill:#fef9c3,stroke:#854d0e,stroke-width:1.2px
    style C3 fill:#fef9c3,stroke:#854d0e,stroke-width:1.2px